# rough systematics computer
# author: Valerio Ippolito <valerio.ippolito@cern.ch>

# look for "kostas" in this file for those changes needed to run only in a restricted signal region

from get_tables import *

import numpy
import math

### GENERAL STUFF

def sum_sq(the_list):
  result = 0

  for an_element in the_list:
    result += an_element * an_element

  return math.sqrt(result)

#tag = 'mc11c'
tag = 'mc12a'


final_sources = ['ZZ', 'redux', 'tot', '125', '130', '150', '190', '400', '600', '120']
final_result_low = {}
final_result_high = {}
for chan in channels:
  final_result_low[chan] = {}
  final_result_high[chan] = {}

  for source in final_sources:
    final_result_low[chan][source] = [0, 0] # val/syst
    final_result_high[chan][source] = [0, 0] # val/syst




### NUMBERS FOR  SIGNALy

if (tag == 'mc11c'):
    listMassSys = [ '1100',
                    '1150',
                    '1200',
                    '1250',
                    '1300',
                    '1400',
                    '1450',
                    '1500',
                    '1600',
                    '1700',
                    '1800',
                    '1850',
                    '1900',
                    '1950',
                    '2000',
                    '2100',
                    '2200',
                    '2400',
                    '2600',
                    '2800',
                    '3000',
                    '3200',
                    '3400',
                    '3600',
                    '3800',
                    '4200',
                    '4400',
                    '4600',
                    '4800',
                    '5000',
                    '5200',
                    '5400',
                    '5600',
                    '5800',
                    '6000' ]

    #   E_EFF
    list_E_EFF_sig_4e = [ '7.109', # 110
                          '7.613', # 115
                          '7.900', # 120
                          '7.794', # 125
                          '7.398', # 130
                          '6.211', # 140
                          '5.816', # 145
                          '5.424', # 150
                          '4.977', # 160
                          '4.391', # 170
                          '3.901', # 180
                          '3.729', # 185
                          '3.728', # 190
                          '3.716', # 195
                          '3.719', # 200
                          '3.782', # 210
                          '3.736', # 220
                          '3.708', # 240
                          '3.625', # 260
                          '3.550', # 280
                          '3.503', # 300
                          '3.450', # 320
                          '3.380', # 340
                          '3.295', # 360
                          '3.304', # 380
                          '3.222', # 420
                          '3.156', # 440
                          '3.178', # 460
                          '3.168', # 480
                          '3.113', # 500
                          '3.071', # 520
                          '3.078', # 540
                          '3.015', # 560
                          '3.035', # 580
                          '3.002' ] # 600
    
    list_E_EFF_sig_2e2mu = [ '2.796', # 110
                             '2.686', # 115
                             '2.710', # 120
                             '2.723', # 125
                             '2.740', # 130
                             '2.795', # 140
                             '2.830', # 145
                             '2.812', # 150
                             '2.831', # 160
                             '2.791', # 170
                             '2.721', # 180
                             '2.666', # 185
                             '2.691', # 190
                             '2.683', # 195
                             '2.691', # 200
                             '2.737', # 210
                             '2.757', # 220
                             '2.743', # 240
                             '2.674', # 260
                             '2.641', # 280
                             '2.632', # 300
                             '2.593', # 320
                             '2.571', # 340
                             '2.562', # 360
                             '2.551', # 380
                             '2.530', # 420
                             '2.494', # 440
                             '2.512', # 460
                             '2.487', # 480
                             '2.490', # 500
                             '2.437', # 520
                             '2.455', # 540
                             '2.449', # 560
                             '2.447', # 580
                             '2.417' ] # 600

    list_E_EFF_sig_2mu2e = [ '5.698', # 110
                             '6.763', # 115
                             '6.910', # 120
                             '7.043', # 125
                             '6.582', # 130
                             '5.778', # 140
                             '5.282', # 145
                             '4.835', # 150
                             '4.257', # 160
                             '3.687', # 170
                             '3.192', # 180
                             '3.080', # 185
                             '3.060', # 190
                             '3.040', # 195
                             '3.033', # 200
                             '3.109', # 210
                             '3.056', # 220
                             '2.976', # 240
                             '2.973', # 260
                             '2.886', # 280
                             '2.885', # 300
                             '2.820', # 320
                             '2.742', # 340
                             '2.728', # 360
                             '2.701', # 380
                             '2.672', # 420
                             '2.636', # 440
                             '2.626', # 460
                             '2.598', # 480
                             '2.619', # 500
                             '2.618', # 520
                             '2.610', # 540
                             '2.596', # 560
                             '2.573', # 580
                             '2.584' ] # 600
    
    # M_EFF
    list_M_EFF_sig_4mu = [ '0.161', # 110
                           '0.162', # 115
                           '0.167', # 120
                           '0.186', # 125
                           '0.191', # 130
                           '0.175', # 140
                           '0.185', # 145
                           '0.195', # 150
                           '0.175', # 160
                           '0.170', # 170
                           '0.166', # 180
                           '0.162', # 185
                           '0.164', # 190
                           '0.168', # 195
                           '0.167', # 200
                           '0.176', # 210
                           '0.177', # 220
                           '0.195', # 240
                           '0.183', # 260
                           '0.192', # 280
                           '0.186', # 300
                           '0.188', # 320
                           '0.194', # 340
                           '0.189', # 360
                           '0.189', # 380
                           '0.198', # 420
                           '0.194', # 440
                           '0.195', # 460
                           '0.190', # 480
                           '0.186', # 500
                           '0.189', # 520
                           '0.186', # 540
                           '0.193', # 560
                           '0.193', # 580
                           '0.190' ] # 600

    list_M_EFF_sig_2e2mu = [ '0.112', # 110
                             '0.114', # 115
                             '0.152', # 120
                             '0.126', # 125
                             '0.151', # 130
                             '0.138', # 140
                             '0.130', # 145
                             '0.125', # 150
                             '0.119', # 160
                             '0.105', # 170
                             '0.117', # 180
                             '0.107', # 185
                             '0.113', # 190
                             '0.109', # 195
                             '0.113', # 200
                             '0.118', # 210
                             '0.120', # 220
                             '0.120', # 240
                             '0.130', # 260
                             '0.118', # 280
                             '0.125', # 300
                             '0.123', # 320
                             '0.122', # 340
                             '0.126', # 360
                             '0.129', # 380
                             '0.127', # 420
                             '0.124', # 440
                             '0.132', # 460
                             '0.123', # 480
                             '0.124', # 500
                             '0.125', # 520
                             '0.131', # 540
                             '0.130', # 560
                             '0.131', # 580
                             '0.126' ] # 600
    
    list_M_EFF_sig_2mu2e = [ '0.102', # 110
                             '0.103', # 115
                             '0.105', # 120
                             '0.108', # 125
                             '0.107', # 130
                             '0.123', # 140
                             '0.107', # 145
                             '0.110', # 150
                             '0.109', # 160
                             '0.112', # 170
                             '0.109', # 180
                             '0.106', # 185
                             '0.115', # 190
                             '0.112', # 195
                             '0.110', # 200
                             '0.110', # 210
                             '0.127', # 220
                             '0.114', # 240
                             '0.121', # 260
                             '0.130', # 280
                             '0.124', # 300
                             '0.116', # 320
                             '0.126', # 340
                             '0.122', # 360
                             '0.126', # 380
                             '0.126', # 420
                             '0.122', # 440
                             '0.118', # 460
                             '0.128', # 480
                             '0.125', # 500
                             '0.124', # 520
                             '0.125', # 540
                             '0.125', # 560
                             '0.125', # 580
                             '0.119' ] # 600

if (tag == 'mc12a'):
    listMassSys = [ '1100', 
                    '1150', 
                    '1200', 
                    '1250', 
                    '1300', 
                    '1350', 
                    '1400', 
                    '1450', 
                    '1500', 
                    '1550', 
                    '1600', 
                    '1650', 
                    '1700', 
                    '1750', 
                    '1800', 
                    '1850', 
                    '1900', 
                    '1950', 
                    '2000', 
                    '2200', 
                    '2400', 
                    '2600', 
                    '2800', 
                    '3000', 
                    '3200', 
                    '3400', 
                    '3600', 
                    '3800', 
                    '4000', 
                    '4200', 
                    '4400', 
                    '4600', 
                    '4800', 
                    '5000', 
                    '5200', 
                    '5400', 
                    '5600', 
                    '5800', 
                    '6000' ] 
    
    # E_EFF
    list_E_EFF_sig_4e = [ '7.853', # 110
                          '8.289', # 115
                          '8.421', # 120
                          '8.005', # 125
                          '7.582', # 130
                          '7.176', # 135
                          '6.522', # 140
                          '5.890', # 145
                          '5.415', # 150
                          '5.025', # 155
                          '4.775', # 160
                          '4.478', # 165
                          '4.093', # 170
                          '3.835', # 175
                          '3.774', # 180
                          '3.328', # 185
                          '3.308', # 190
                          '3.380', # 195
                          '3.380', # 200
                          '3.501', # 220
                          '3.240', # 240
                          '3.268', # 260
                          '3.070', # 280
                          '3.099', # 300
                          '3.030', # 320
                          '2.772', # 340
                          '2.887', # 360
                          '2.839', # 380
                          '2.747', # 400
                          '2.793', # 420
                          '2.569', # 440
                          '2.638', # 460
                          '2.664', # 480
                          '2.596', # 500
                          '2.594', # 520
                          '2.546', # 540
                          '2.541', # 560
                          '2.593', # 580
                          '2.556' ] # 600

    list_E_EFF_sig_2e2mu = [ '2.539', # 110
                             '2.308', # 115
                             '2.118', # 120
                             '2.092', # 125
                             '2.080', # 130
                             '2.063', # 135
                             '2.110', # 140
                             '2.070', # 145
                             '2.103', # 150
                             '1.953', # 155
                             '2.087', # 160
                             '2.163', # 165
                             '2.141', # 170
                             '1.998', # 175
                             '1.960', # 180
                             '1.900', # 185
                             '1.983', # 190
                             '1.910', # 195
                             '2.024', # 200
                             '1.994', # 220
                             '1.944', # 240
                             '1.932', # 260
                             '1.929', # 280
                             '1.844', # 300
                             '1.879', # 320
                             '1.838', # 340
                             '1.806', # 360
                             '1.784', # 380
                             '1.714', # 400
                             '1.742', # 420
                             '1.725', # 440
                             '1.742', # 460
                             '1.668', # 480
                             '1.668', # 500
                             '1.642', # 520
                             '1.700', # 540
                             '1.692', # 560
                             '1.684', # 580
                             '1.684' ] # 600
    
    list_E_EFF_sig_2mu2e = [ '6.791', # 110
                             '7.624', # 115
                             '7.856', # 120
                             '7.505', # 125
                             '6.733', # 130
                             '6.110', # 135
                             '5.529', # 140
                             '4.890', # 145
                             '4.401', # 150
                             '4.165', # 155
                             '3.849', # 160
                             '3.397', # 165
                             '3.073', # 170
                             '2.940', # 175
                             '2.541', # 180
                             '2.426', # 185
                             '2.468', # 190
                             '2.357', # 195
                             '2.452', # 200
                             '2.392', # 220
                             '2.357', # 240
                             '2.278', # 260
                             '2.212', # 280
                             '2.111', # 300
                             '2.104', # 320
                             '2.020', # 340
                             '2.005', # 360
                             '1.909', # 380
                             '1.901', # 400
                             '1.928', # 420
                             '1.871', # 440
                             '1.892', # 460
                             '1.852', # 480
                             '1.864', # 500
                             '1.794', # 520
                             '1.900', # 540
                             '1.760', # 560
                             '1.749', # 580
                             '1.767' ] # 600
    

    # M_EFF
    list_M_EFF_sig_4mu = [ '0.159', # 110
                           '0.157', # 115
                           '0.155', # 120
                           '0.158', # 125
                           '0.155', # 130
                           '0.153', # 135
                           '0.154', # 140
                           '0.155', # 145
                           '0.153', # 150
                           '0.154', # 155
                           '0.151', # 160
                           '0.152', # 165
                           '0.153', # 170
                           '0.152', # 175
                           '0.147', # 180
                           '0.148', # 185
                           '0.147', # 190
                           '0.150', # 195
                           '0.149', # 200
                           '0.150', # 220
                           '0.151', # 240
                           '0.149', # 260
                           '0.148', # 280
                           '0.148', # 300
                           '0.148', # 320
                           '0.149', # 340
                           '0.150', # 360
                           '0.148', # 380
                           '0.146', # 400
                           '0.149', # 420
                           '0.147', # 440
                           '0.147', # 460
                           '0.148', # 480
                           '0.147', # 500
                           '0.149', # 520
                           '0.148', # 540
                           '0.149', # 560
                           '0.148', # 580
                           '0.148' ] # 600
    
    list_M_EFF_sig_2e2mu = [ '0.108', # 110
                             '0.115', # 115
                             '0.115', # 120
                             '0.111', # 125
                             '0.112', # 130
                             '0.110', # 135
                             '0.115', # 140
                             '0.109', # 145
                             '0.110', # 150
                             '0.111', # 155
                             '0.108', # 160
                             '0.109', # 165
                             '0.106', # 170
                             '0.105', # 175
                             '0.104', # 180
                             '0.105', # 185
                             '0.104', # 190
                             '0.105', # 195
                             '0.103', # 200
                             '0.107', # 220
                             '0.103', # 240
                             '0.103', # 260
                             '0.106', # 280
                             '0.103', # 300
                             '0.105', # 320
                             '0.103', # 340
                             '0.102', # 360
                             '0.102', # 380
                             '0.104', # 400
                             '0.104', # 420
                             '0.103', # 440
                             '0.102', # 460
                             '0.103', # 480
                             '0.104', # 500
                             '0.104', # 520
                             '0.103', # 540
                             '0.103', # 560
                             '0.104', # 580
                             '0.103' ] # 600
    
    list_M_EFF_sig_2mu2e = [ '0.108', # 110
                             '0.105', # 115
                             '0.103', # 120
                             '0.105', # 125
                             '0.104', # 130
                             '0.104', # 135
                             '0.104', # 140
                             '0.103', # 145
                             '0.103', # 150
                             '0.102', # 155
                             '0.103', # 160
                             '0.102', # 165
                             '0.103', # 170
                             '0.102', # 175
                             '0.103', # 180
                             '0.104', # 185
                             '0.103', # 190
                             '0.104', # 195
                             '0.105', # 200
                             '0.104', # 220
                             '0.103', # 240
                             '0.106', # 260
                             '0.103', # 280
                             '0.103', # 300
                             '0.104', # 320
                             '0.105', # 340
                             '0.105', # 360
                             '0.103', # 380
                             '0.104', # 400
                             '0.105', # 420
                             '0.104', # 440
                             '0.103', # 460
                             '0.104', # 480
                             '0.105', # 500
                             '0.103', # 520
                             '0.105', # 540
                             '0.104', # 560
                             '0.103', # 580
                             '0.105' ] # 600
    
##########################################

##########################################
##   E_CUTS_EFF (track/calo iso and d0 
list_E_CUTS_EFF_sig_4e = [ '6.285', # 110
                           '6.409', # 115
                           '6.088', # 120
                           '5.727', # 125
                           '5.361', # 130
                           '5.034', # 135
                           '4.553', # 140
                           '4.266', # 145
                           '4.012', # 150
                           '2.923', # 180
                           '2.779', # 200
                           '2.735', # 260
                           '2.452', # 360
                           '2.349', # 460
                           '2.219' ]# 600

list_E_CUTS_EFF_sig_2e2mu = [ '1.632', # 110
                              '1.659', # 115
                              '1.685', # 120
                              '1.669', # 125
                              '1.732', # 130
                              '1.730', # 135
                              '1.759', # 140
                              '1.776', # 145
                              '1.763', # 150
                              '1.756', # 180
                              '1.744', # 200
                              '1.724', # 260
                              '1.600', # 360
                              '1.550', # 460
                              '1.469' ]# 600

list_E_CUTS_EFF_sig_2mu2e = [ '5.996', # 110
                              '5.932', # 115
                              '5.573', # 120
                              '5.254', # 125
                              '4.767', # 130
                              '4.309', # 135
                              '4.018', # 140
                              '3.621', # 145
                              '3.366', # 150
                              '2.122', # 180
                              '2.039', # 200
                              '1.926', # 260
                              '1.761', # 360
                              '1.672', # 460
                              '1.641' ]# 600

listMassSys2 = [ '1100', 
                 '1150', 
                 '1200', 
                 '1250', 
                 '1300', 
                 '1350', 
                 '1400', 
                 '1450', 
                 '1500', 
                 '1550', 
                 '1600', 
                 '1650', 
                 '1700', 
                 '1750', 
                 '1800', 
                 '1850', 
                 '1900', 
                 '1950', 
                 '2000', 
                 '2200', 
                 '2400', 
                 '2600', 
                 '2800', 
                 '3000', 
                 '3200', 
                 '3400', 
                 '3600', 
                 '3800', 
                 '4000', 
                 '4200', 
                 '4400', 
                 '4600', 
                 '4800', 
                 '5000', 
                 '5200', 
                 '5400', 
                 '5600', 
                 '5800', 
                 '6000' ] 


## Trigger systematic
## E_TRIG
list_E_TRIG_sig_4e = [ '0.561', # 110
                       '0.502', # 115
                       '0.426', # 120
                       '0.410', # 125
                       '0.389', # 130
                       '0.365', # 135
                       '0.314', # 140
                       '0.279', # 145
                       '0.243', # 150
                       '0.180', # 155
                       '0.146', # 160
                       '0.144', # 165
                       '0.127', # 170
                       '0.112', # 175
                       '0.083', # 180
                       '0.075', # 185
                       '0.077', # 190
                       '0.078', # 195
                       '0.066', # 200
                       '0.052', # 220
                       '0.043', # 240
                       '0.033', # 260
                       '0.029', # 280
                       '0.025', # 300
                       '0.021', # 320
                       '0.017', # 340
                       '0.019', # 360
                       '0.014', # 380
                       '0.017', # 400
                       '0.013', # 420
                       '0.012', # 440
                       '0.011', # 460
                       '0.012', # 480
                       '0.012', # 500
                       '0.013', # 520
                       '0.012', # 540
                       '0.009', # 560
                       '0.011', # 580
                       '0.010' ] # 600

list_E_TRIG_sig_2e2mu = [ '0.551', # 110
                          '0.470', # 115
                          '0.451', # 120
                          '0.423', # 125
                          '0.395', # 130
                          '0.341', # 135
                          '0.305', # 140
                          '0.267', # 145
                          '0.224', # 150
                          '0.181', # 155
                          '0.186', # 160
                          '0.163', # 165
                          '0.154', # 170
                          '0.121', # 175
                          '0.106', # 180
                          '0.088', # 185
                          '0.092', # 190
                          '0.092', # 195
                          '0.099', # 200
                          '0.093', # 220
                          '0.092', # 240
                          '0.077', # 260
                          '0.066', # 280
                          '0.062', # 300
                          '0.055', # 320
                          '0.054', # 340
                          '0.049', # 360
                          '0.047', # 380
                          '0.051', # 400
                          '0.049', # 420
                          '0.043', # 440
                          '0.048', # 460
                          '0.045', # 480
                          '0.040', # 500
                          '0.040', # 520
                          '0.043', # 540
                          '0.044', # 560
                          '0.047', # 580
                          '0.042' ] # 600

list_E_TRIG_sig_2mu2e = [ '0.174', # 110
                          '0.125', # 115
                          '0.093', # 120
                          '0.102', # 125
                          '0.100', # 130
                          '0.115', # 135
                          '0.148', # 140
                          '0.154', # 145
                          '0.166', # 150
                          '0.182', # 155
                          '0.155', # 160
                          '0.153', # 165
                          '0.136', # 170
                          '0.121', # 175
                          '0.097', # 180
                          '0.106', # 185
                          '0.090', # 190
                          '0.093', # 195
                          '0.097', # 200
                          '0.096', # 220
                          '0.090', # 240
                          '0.086', # 260
                          '0.072', # 280
                          '0.076', # 300
                          '0.066', # 320
                          '0.067', # 340
                          '0.061', # 360
                          '0.057', # 380
                          '0.057', # 400
                          '0.055', # 420
                          '0.055', # 440
                          '0.061', # 460
                          '0.055', # 480
                          '0.055', # 500
                          '0.054', # 520
                          '0.057', # 540
                          '0.051', # 560
                          '0.054', # 580
                          '0.053' ] # 600


## M_TRIG
list_M_TRIG_sig_4mu = [ '1.221', # 110
                        '1.149', # 115
                        '1.141', # 120
                        '1.105', # 125
                        '1.023', # 130
                        '0.979', # 135
                        '0.893', # 140
                        '0.847', # 145
                        '0.775', # 150
                        '0.709', # 155
                        '0.638', # 160
                        '0.588', # 165
                        '0.530', # 170
                        '0.499', # 175
                        '0.446', # 180
                        '0.425', # 185
                        '0.388', # 190
                        '0.403', # 195
                        '0.399', # 200
                        '0.397', # 220
                        '0.394', # 240
                        '0.344', # 260
                        '0.344', # 280
                        '0.343', # 300
                        '0.295', # 320
                        '0.296', # 340
                        '0.285', # 360
                        '0.283', # 380
                        '0.268', # 400
                        '0.266', # 420
                        '0.248', # 440
                        '0.254', # 460
                        '0.254', # 480
                        '0.237', # 500
                        '0.254', # 520
                        '0.249', # 540
                        '0.226', # 560
                        '0.227', # 580
                        '0.245' ] # 600

list_M_TRIG_sig_2e2mu = [ '0.141', # 110
                          '0.137', # 115
                          '0.094', # 120
                          '0.079', # 125
                          '0.082', # 130
                          '0.105', # 135
                          '0.131', # 140
                          '0.126', # 145
                          '0.149', # 150
                          '0.145', # 155
                          '0.128', # 160
                          '0.148', # 165
                          '0.159', # 170
                          '0.126', # 175
                          '0.128', # 180
                          '0.100', # 185
                          '0.102', # 190
                          '0.097', # 195
                          '0.096', # 200
                          '0.109', # 220
                          '0.097', # 240
                          '0.086', # 260
                          '0.075', # 280
                          '0.062', # 300
                          '0.057', # 320
                          '0.056', # 340
                          '0.047', # 360
                          '0.052', # 380
                          '0.045', # 400
                          '0.043', # 420
                          '0.040', # 440
                          '0.044', # 460
                          '0.038', # 480
                          '0.034', # 500
                          '0.033', # 520
                          '0.033', # 540
                          '0.036', # 560
                          '0.035', # 580
                          '0.034' ] # 600

list_M_TRIG_sig_2mu2e = [ '0.945', # 110
                          '0.989', # 115
                          '0.961', # 120
                          '0.964', # 125
                          '0.880', # 130
                          '0.809', # 135
                          '0.693', # 140
                          '0.595', # 145
                          '0.508', # 150
                          '0.402', # 155
                          '0.351', # 160
                          '0.282', # 165
                          '0.249', # 170
                          '0.215', # 175
                          '0.185', # 180
                          '0.156', # 185
                          '0.155', # 190
                          '0.157', # 195
                          '0.147', # 200
                          '0.135', # 220
                          '0.122', # 240
                          '0.106', # 260
                          '0.093', # 280
                          '0.087', # 300
                          '0.076', # 320
                          '0.070', # 340
                          '0.069', # 360
                          '0.058', # 380
                          '0.060', # 400
                          '0.059', # 420
                          '0.056', # 440
                          '0.054', # 460
                          '0.055', # 480
                          '0.058', # 500
                          '0.053', # 520
                          '0.053', # 540
                          '0.046', # 560
                          '0.047', # 580
                          '0.044' ] # 600

## E_CUTS
list_E_CUTS_sig_4e = [ '2.944', # 110
                       '3.125', # 115
                       '3.296', # 120
                       '3.112', # 125
                       '2.749', # 130
                       '2.462', # 135
                       '2.072', # 140
                       '1.760', # 145
                       '1.491', # 150
                       '1.305', # 155
                       '1.117', # 160
                       '0.929', # 165
                       '0.818', # 170
                       '0.655', # 175
                       '0.569', # 180
                       '0.386', # 185
                       '0.427', # 190
                       '0.416', # 195
                       '0.448', # 200
                       '0.446', # 220
                       '0.403', # 240
                       '0.419', # 260
                       '0.355', # 280
                       '0.326', # 300
                       '0.298', # 320
                       '0.236', # 340
                       '0.298', # 360
                       '0.252', # 380
                       '0.233', # 400
                       '0.236', # 420
                       '0.150', # 440
                       '0.186', # 460
                       '0.188', # 480
                       '0.192', # 500
                       '0.174', # 520
                       '0.163', # 540
                       '0.132', # 560
                       '0.177', # 580
                       '0.160' ] # 600

list_E_CUTS_sig_2e2mu = [ '0.383', # 110
                          '0.262', # 115
                          '0.181', # 120
                          '0.184', # 125
                          '0.186', # 130
                          '0.158', # 135
                          '0.175', # 140
                          '0.156', # 145
                          '0.165', # 150
                          '0.119', # 155
                          '0.187', # 160
                          '0.166', # 165
                          '0.200', # 170
                          '0.135', # 175
                          '0.116', # 180
                          '0.097', # 185
                          '0.120', # 190
                          '0.131', # 195
                          '0.145', # 200
                          '0.152', # 220
                          '0.154', # 240
                          '0.123', # 260
                          '0.139', # 280
                          '0.112', # 300
                          '0.113', # 320
                          '0.102', # 340
                          '0.096', # 360
                          '0.095', # 380
                          '0.054', # 400
                          '0.088', # 420
                          '0.075', # 440
                          '0.074', # 460
                          '0.042', # 480
                          '0.048', # 500
                          '0.033', # 520
                          '0.063', # 540
                          '0.062', # 560
                          '0.064', # 580
                          '0.053' ] # 600

list_E_CUTS_sig_2mu2e = [ '2.514', # 110
                          '2.962', # 115
                          '3.131', # 120
                          '2.857', # 125
                          '2.568', # 130
                          '2.192', # 135
                          '1.855', # 140
                          '1.526', # 145
                          '1.224', # 150
                          '1.097', # 155
                          '0.981', # 160
                          '0.765', # 165
                          '0.610', # 170
                          '0.514', # 175
                          '0.337', # 180
                          '0.302', # 185
                          '0.320', # 190
                          '0.280', # 195
                          '0.311', # 200
                          '0.292', # 220
                          '0.292', # 240
                          '0.248', # 260
                          '0.235', # 280
                          '0.183', # 300
                          '0.197', # 320
                          '0.156', # 340
                          '0.167', # 360
                          '0.143', # 380
                          '0.119', # 400
                          '0.150', # 420
                          '0.111', # 440
                          '0.126', # 460
                          '0.124', # 480
                          '0.117', # 500
                          '0.079', # 520
                          '0.115', # 540
                          '0.089', # 560
                          '0.075', # 580
                          '0.093' ] # 600

### NUMBERS FOR ZZ ###

def get_theory_qqZZ_relative_syst(mass):
  pdf = 0.0035 * math.sqrt(mass-30)
  scale = 0.01 * math.sqrt((mass-20)/13)

  return sum_sq([pdf, scale])

def get_theory_ggZZ_relative_syst(mass):
  pdf = 0.0066 * math.sqrt(mass-10)
  scale = 0.04 + 0.01 * math.sqrt((mass+40)/40)

  return sum_sq([pdf, scale])


## E_EFF
list_E_EFF_bg_4e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'14.754', #  70- 80
'10.169', #  80- 90
'10.175', #  90-100
'9.108', # 100-110
'10.959', # 110-120
'9.394', # 120-130
'8.189', # 130-140
'7.402', # 140-150
'6.903', # 150-160
'6.261', # 160-170
'3.966', # 170-180
'3.157', # 180-190
'3.020', # 190-200
'3.161', # 200-210
'3.368', # 210-220
'3.356', # 220-230
'3.402', # 230-240
'3.209', # 240-250
'3.421', # 250-275
'3.469', # 275-300
'3.657', # 300-325
'3.488', # 325-350
'3.273', # 350-375
'3.371', # 375-400
'3.380', # 400-425
'3.698', # 425-450
'3.748', # 450-475
'3.283', # 475-500
'3.707', # 500-550
'3.343', # 550-600
'3.086', # 600-650
'3.911', # 650-700
'3.412', # 700-750
'3.596' ] # 750-800

list_E_EFF_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'1.844', #  70- 80
'2.290', #  80- 90
'2.436', #  90-100
'2.514', # 100-110
'2.316', # 110-120
'2.112', # 120-130
'2.152', # 130-140
'1.846', # 140-150
'1.984', # 150-160
'2.185', # 160-170
'2.368', # 170-180
'1.950', # 180-190
'1.970', # 190-200
'1.844', # 200-210
'1.851', # 210-220
'2.048', # 220-230
'2.028', # 230-240
'2.038', # 240-250
'2.064', # 250-275
'1.882', # 275-300
'2.258', # 300-325
'2.398', # 325-350
'1.957', # 350-375
'1.938', # 375-400
'2.084', # 400-425
'2.262', # 425-450
'2.165', # 450-475
'2.228', # 475-500
'2.111', # 500-550
'2.426', # 550-600
'1.792', # 600-650
'2.075', # 650-700
'1.640', # 700-750
'3.189' ] # 750-800

list_E_EFF_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'10.602', #  70- 80
'10.340', #  80- 90
'10.012', #  90-100
'12.193', # 100-110
'9.679', # 110-120
'9.350', # 120-130
'7.306', # 130-140
'5.318', # 140-150
'5.390', # 150-160
'3.628', # 160-170
'2.896', # 170-180
'2.357', # 180-190
'2.144', # 190-200
'2.155', # 200-210
'2.190', # 210-220
'2.092', # 220-230
'2.495', # 230-240
'2.416', # 240-250
'2.403', # 250-275
'2.318', # 275-300
'2.482', # 300-325
'2.122', # 325-350
'2.226', # 350-375
'2.402', # 375-400
'2.287', # 400-425
'2.129', # 425-450
'2.793', # 450-475
'2.478', # 475-500
'2.335', # 500-550
'2.299', # 550-600
'1.930', # 600-650
'1.564', # 650-700
'1.601', # 700-750
'1.559' ] # 750-800


## M_EFF
list_M_EFF_bg_4mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.096', #  70- 80
'0.114', #  80- 90
'0.113', #  90-100
'0.108', # 100-110
'0.109', # 110-120
'0.114', # 120-130
'0.109', # 130-140
'0.114', # 140-150
'0.113', # 150-160
'0.114', # 160-170
'0.108', # 170-180
'0.109', # 180-190
'0.109', # 190-200
'0.110', # 200-210
'0.110', # 210-220
'0.113', # 220-230
'0.112', # 230-240
'0.110', # 240-250
'0.112', # 250-275
'0.110', # 275-300
'0.113', # 300-325
'0.109', # 325-350
'0.110', # 350-375
'0.108', # 375-400
'0.110', # 400-425
'0.107', # 425-450
'0.112', # 450-475
'0.116', # 475-500
'0.104', # 500-550
'0.106', # 550-600
'0.111', # 600-650
'0.102', # 650-700
'0.105', # 700-750
'0.115' ] # 750-800

list_M_EFF_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.056', #  70- 80
'0.074', #  80- 90
'0.074', #  90-100
'0.074', # 100-110
'0.100', # 110-120
'0.092', # 120-130
'0.080', # 130-140
'0.082', # 140-150
'0.073', # 150-160
'0.072', # 160-170
'0.078', # 170-180
'0.079', # 180-190
'0.078', # 190-200
'0.085', # 200-210
'0.076', # 210-220
'0.077', # 220-230
'0.076', # 230-240
'0.076', # 240-250
'0.078', # 250-275
'0.076', # 275-300
'0.084', # 300-325
'0.078', # 325-350
'0.075', # 350-375
'0.089', # 375-400
'0.074', # 400-425
'0.075', # 425-450
'0.077', # 450-475
'0.067', # 475-500
'0.071', # 500-550
'0.077', # 550-600
'0.077', # 600-650
'0.073', # 650-700
'0.072', # 700-750
'0.063' ] # 750-800

list_M_EFF_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.082', #  70- 80
'0.079', #  80- 90
'0.078', #  90-100
'0.077', # 100-110
'0.075', # 110-120
'0.077', # 120-130
'0.076', # 130-140
'0.074', # 140-150
'0.074', # 150-160
'0.076', # 160-170
'0.078', # 170-180
'0.076', # 180-190
'0.077', # 190-200
'0.077', # 200-210
'0.079', # 210-220
'0.077', # 220-230
'0.082', # 230-240
'0.077', # 240-250
'0.078', # 250-275
'0.078', # 275-300
'0.078', # 300-325
'0.074', # 325-350
'0.075', # 350-375
'0.073', # 375-400
'0.072', # 400-425
'0.079', # 425-450
'0.076', # 450-475
'0.075', # 475-500
'0.077', # 500-550
'0.077', # 550-600
'0.081', # 600-650
'0.067', # 650-700
'0.066', # 700-750
'0.059' ] # 750-800


## E_TRIG
list_E_TRIG_bg_4e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'1.015', #  70- 80
'0.966', #  80- 90
'0.810', #  90-100
'0.778', # 100-110
'0.574', # 110-120
'0.434', # 120-130
'0.456', # 130-140
'0.318', # 140-150
'0.256', # 150-160
'0.200', # 160-170
'0.125', # 170-180
'0.060', # 180-190
'0.051', # 190-200
'0.059', # 200-210
'0.062', # 210-220
'0.053', # 220-230
'0.067', # 230-240
'0.048', # 240-250
'0.056', # 250-275
'0.059', # 275-300
'0.055', # 300-325
'0.059', # 325-350
'0.052', # 350-375
'0.058', # 375-400
'0.037', # 400-425
'0.054', # 425-450
'0.088', # 450-475
'0.049', # 475-500
'0.051', # 500-550
'0.039', # 550-600
'0.049', # 600-650
'0.071', # 650-700
'0.036', # 700-750
'0.015' ] # 750-800

list_E_TRIG_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'2.166', #  70- 80
'0.835', #  80- 90
'0.810', #  90-100
'0.690', # 100-110
'0.400', # 110-120
'0.472', # 120-130
'0.270', # 130-140
'0.306', # 140-150
'0.193', # 150-160
'0.233', # 160-170
'0.097', # 170-180
'0.099', # 180-190
'0.092', # 190-200
'0.078', # 200-210
'0.080', # 210-220
'0.104', # 220-230
'0.096', # 230-240
'0.107', # 240-250
'0.094', # 250-275
'0.098', # 275-300
'0.094', # 300-325
'0.095', # 325-350
'0.116', # 350-375
'0.082', # 375-400
'0.070', # 400-425
'0.081', # 425-450
'0.116', # 450-475
'0.093', # 475-500
'0.085', # 500-550
'0.134', # 550-600
'0.196', # 600-650
'0.046', # 650-700
'0.089', # 700-750
'0.138' ] # 750-800

list_E_TRIG_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.001', #  80- 90
'0.058', #  90-100
'0.015', # 100-110
'0.041', # 110-120
'0.050', # 120-130
'0.139', # 130-140
'0.272', # 140-150
'0.095', # 150-160
'0.170', # 160-170
'0.088', # 170-180
'0.073', # 180-190
'0.089', # 190-200
'0.089', # 200-210
'0.109', # 210-220
'0.091', # 220-230
'0.100', # 230-240
'0.117', # 240-250
'0.136', # 250-275
'0.112', # 275-300
'0.122', # 300-325
'0.092', # 325-350
'0.153', # 350-375
'0.119', # 375-400
'0.117', # 400-425
'0.115', # 425-450
'0.109', # 450-475
'0.104', # 475-500
'0.149', # 500-550
'0.161', # 550-600
'0.048', # 600-650
'0.011', # 650-700
'0.064', # 700-750
'0.151' ] # 750-800


## M_TRIG
list_M_TRIG_bg_4mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'1.313', #  70- 80
'1.359', #  80- 90
'1.473', #  90-100
'1.411', # 100-110
'1.120', # 110-120
'1.206', # 120-130
'1.087', # 130-140
'0.875', # 140-150
'0.860', # 150-160
'0.691', # 160-170
'0.533', # 170-180
'0.392', # 180-190
'0.339', # 190-200
'0.367', # 200-210
'0.357', # 210-220
'0.425', # 220-230
'0.399', # 230-240
'0.410', # 240-250
'0.373', # 250-275
'0.380', # 275-300
'0.379', # 300-325
'0.402', # 325-350
'0.398', # 350-375
'0.354', # 375-400
'0.330', # 400-425
'0.327', # 425-450
'0.390', # 450-475
'0.416', # 475-500
'0.280', # 500-550
'0.288', # 550-600
'0.400', # 600-650
'0.236', # 650-700
'0.202', # 700-750
'0.106' ] # 750-800

list_M_TRIG_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.028', #  80- 90
'0.048', #  90-100
'0.035', # 100-110
'0.179', # 110-120
'0.040', # 120-130
'0.061', # 130-140
'0.193', # 140-150
'0.142', # 150-160
'0.103', # 160-170
'0.114', # 170-180
'0.133', # 180-190
'0.093', # 190-200
'0.081', # 200-210
'0.099', # 210-220
'0.117', # 220-230
'0.119', # 230-240
'0.103', # 240-250
'0.098', # 250-275
'0.115', # 275-300
'0.102', # 300-325
'0.130', # 325-350
'0.121', # 350-375
'0.088', # 375-400
'0.176', # 400-425
'0.068', # 425-450
'0.083', # 450-475
'0.120', # 475-500
'0.091', # 500-550
'0.072', # 550-600
'0.289', # 600-650
'0.041', # 650-700
'0.069', # 700-750
'0.282' ] # 750-800

list_M_TRIG_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'2.128', #  70- 80
'1.250', #  80- 90
'1.452', #  90-100
'1.028', # 100-110
'1.311', # 110-120
'1.027', # 120-130
'0.649', # 130-140
'0.558', # 140-150
'0.544', # 150-160
'0.311', # 160-170
'0.239', # 170-180
'0.155', # 180-190
'0.115', # 190-200
'0.111', # 200-210
'0.122', # 210-220
'0.108', # 220-230
'0.145', # 230-240
'0.140', # 240-250
'0.132', # 250-275
'0.120', # 275-300
'0.115', # 300-325
'0.103', # 325-350
'0.164', # 350-375
'0.134', # 375-400
'0.128', # 400-425
'0.098', # 425-450
'0.092', # 450-475
'0.091', # 475-500
'0.102', # 500-550
'0.169', # 550-600
'0.042', # 600-650
'0.010', # 650-700
'0.084', # 700-750
'0.115' ] # 750-800


## E_CUTS
list_E_CUTS_bg_4e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'4.829', #  70- 80
'4.219', #  80- 90
'3.988', #  90-100
'3.275', # 100-110
'4.121', # 110-120
'3.524', # 120-130
'3.137', # 130-140
'2.461', # 140-150
'2.132', # 150-160
'1.690', # 160-170
'0.727', # 170-180
'0.333', # 180-190
'0.287', # 190-200
'0.332', # 200-210
'0.435', # 210-220
'0.453', # 220-230
'0.432', # 230-240
'0.394', # 240-250
'0.487', # 250-275
'0.585', # 275-300
'0.624', # 300-325
'0.659', # 325-350
'0.516', # 350-375
'0.559', # 375-400
'0.591', # 400-425
'0.846', # 425-450
'0.650', # 450-475
'0.575', # 475-500
'0.852', # 500-550
'0.643', # 550-600
'0.559', # 600-650
'1.038', # 650-700
'0.707', # 700-750
'0.952' ] # 750-800

list_E_CUTS_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.138', #  80- 90
'0.274', #  90-100
'0.564', # 100-110
'0.240', # 110-120
'0.132', # 120-130
'0.179', # 130-140
'0.068', # 140-150
'0.168', # 150-160
'0.211', # 160-170
'0.265', # 170-180
'0.137', # 180-190
'0.169', # 190-200
'0.078', # 200-210
'0.079', # 210-220
'0.168', # 220-230
'0.119', # 230-240
'0.186', # 240-250
'0.194', # 250-275
'0.129', # 275-300
'0.240', # 300-325
'0.362', # 325-350
'0.195', # 350-375
'0.134', # 375-400
'0.150', # 400-425
'0.418', # 425-450
'0.265', # 450-475
'0.301', # 475-500
'0.362', # 500-550
'0.596', # 550-600
'0.101', # 600-650
'0.366', # 650-700
'0.000', # 700-750
'0.390' ] # 750-800

list_E_CUTS_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'5.600', #  70- 80
'4.320', #  80- 90
'3.857', #  90-100
'4.129', # 100-110
'3.637', # 110-120
'3.507', # 120-130
'2.915', # 130-140
'1.664', # 140-150
'1.113', # 150-160
'0.987', # 160-170
'0.444', # 170-180
'0.216', # 180-190
'0.204', # 190-200
'0.214', # 200-210
'0.210', # 210-220
'0.201', # 220-230
'0.270', # 230-240
'0.363', # 240-250
'0.309', # 250-275
'0.261', # 275-300
'0.314', # 300-325
'0.170', # 325-350
'0.236', # 350-375
'0.461', # 375-400
'0.382', # 400-425
'0.325', # 425-450
'0.440', # 450-475
'0.571', # 475-500
'0.425', # 500-550
'0.208', # 550-600
'0.177', # 600-650
'0.000', # 650-700
'0.000', # 700-750
'0.000' ] # 750-800

## E_EFF
list_E_EFF_bg_4e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'9.174', #  70- 80
'10.421', #  80- 90
'10.184', #  90-100
'9.605', # 100-110
'8.793', # 110-120
'8.427', # 120-130
'7.071', # 130-140
'6.160', # 140-150
'5.435', # 150-160
'5.117', # 160-170
'4.077', # 170-180
'3.488', # 180-190
'3.276', # 190-200
'3.438', # 200-210
'3.288', # 210-220
'3.441', # 220-230
'3.523', # 230-240
'3.527', # 240-250
'3.601', # 250-275
'3.583', # 275-300
'3.521', # 300-325
'3.533', # 325-350
'3.657', # 350-375
'3.493', # 375-400
'3.943', # 400-425
'3.354', # 425-450
'3.636', # 450-475
'3.498', # 475-500
'3.067', # 500-550
'2.858', # 550-600
'3.444', # 600-650
'2.838', # 650-700
'2.825', # 700-750
'2.561' ] # 750-800

list_E_EFF_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'1.994', #  80- 90
'3.410', #  90-100
'2.296', # 100-110
'2.557', # 110-120
'2.181', # 120-130
'1.702', # 130-140
'2.039', # 140-150
'2.297', # 150-160
'2.072', # 160-170
'1.916', # 170-180
'2.000', # 180-190
'1.936', # 190-200
'1.910', # 200-210
'1.989', # 210-220
'2.040', # 220-230
'2.088', # 230-240
'2.129', # 240-250
'2.138', # 250-275
'2.211', # 275-300
'2.284', # 300-325
'2.137', # 325-350
'2.483', # 350-375
'2.057', # 375-400
'2.294', # 400-425
'1.997', # 425-450
'2.066', # 450-475
'2.106', # 475-500
'1.969', # 500-550
'2.222', # 550-600
'1.780', # 600-650
'1.707', # 650-700
'1.534', # 700-750
'1.534' ] # 750-800

list_E_EFF_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'9.162', #  80- 90
'7.302', #  90-100
'7.497', # 100-110
'9.081', # 110-120
'6.141', # 120-130
'6.422', # 130-140
'5.591', # 140-150
'5.020', # 150-160
'3.359', # 160-170
'3.136', # 170-180
'2.346', # 180-190
'2.383', # 190-200
'2.369', # 200-210
'2.484', # 210-220
'2.332', # 220-230
'2.480', # 230-240
'2.340', # 240-250
'2.507', # 250-275
'2.652', # 275-300
'2.399', # 300-325
'2.473', # 325-350
'2.471', # 350-375
'2.513', # 375-400
'3.077', # 400-425
'2.572', # 425-450
'2.439', # 450-475
'2.572', # 475-500
'2.107', # 500-550
'2.401', # 550-600
'2.893', # 600-650
'2.046', # 650-700
'2.412', # 700-750
'2.728' ] # 750-800


## M_EFF
list_M_EFF_bg_4mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.123', #  70- 80
'0.111', #  80- 90
'0.112', #  90-100
'0.127', # 100-110
'0.136', # 110-120
'0.109', # 120-130
'0.114', # 130-140
'0.111', # 140-150
'0.125', # 150-160
'0.116', # 160-170
'0.115', # 170-180
'0.112', # 180-190
'0.115', # 190-200
'0.113', # 200-210
'0.112', # 210-220
'0.113', # 220-230
'0.112', # 230-240
'0.113', # 240-250
'0.113', # 250-275
'0.113', # 275-300
'0.117', # 300-325
'0.116', # 325-350
'0.111', # 350-375
'0.112', # 375-400
'0.110', # 400-425
'0.112', # 425-450
'0.111', # 450-475
'0.118', # 475-500
'0.114', # 500-550
'0.110', # 550-600
'0.111', # 600-650
'0.108', # 650-700
'0.110', # 700-750
'0.112' ] # 750-800

list_M_EFF_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.056', #  80- 90
'0.070', #  90-100
'0.082', # 100-110
'0.081', # 110-120
'0.084', # 120-130
'0.080', # 130-140
'0.085', # 140-150
'0.098', # 150-160
'0.078', # 160-170
'0.085', # 170-180
'0.080', # 180-190
'0.080', # 190-200
'0.078', # 200-210
'0.078', # 210-220
'0.078', # 220-230
'0.077', # 230-240
'0.081', # 240-250
'0.080', # 250-275
'0.085', # 275-300
'0.078', # 300-325
'0.081', # 325-350
'0.077', # 350-375
'0.077', # 375-400
'0.080', # 400-425
'0.076', # 425-450
'0.079', # 450-475
'0.074', # 475-500
'0.077', # 500-550
'0.080', # 550-600
'0.077', # 600-650
'0.075', # 650-700
'0.075', # 700-750
'0.079' ] # 750-800

list_M_EFF_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.073', #  80- 90
'0.082', #  90-100
'0.066', # 100-110
'0.080', # 110-120
'0.075', # 120-130
'0.079', # 130-140
'0.080', # 140-150
'0.077', # 150-160
'0.078', # 160-170
'0.077', # 170-180
'0.078', # 180-190
'0.077', # 190-200
'0.079', # 200-210
'0.078', # 210-220
'0.078', # 220-230
'0.082', # 230-240
'0.083', # 240-250
'0.081', # 250-275
'0.078', # 275-300
'0.077', # 300-325
'0.081', # 325-350
'0.078', # 350-375
'0.079', # 375-400
'0.077', # 400-425
'0.078', # 425-450
'0.077', # 450-475
'0.077', # 475-500
'0.095', # 500-550
'0.077', # 550-600
'0.076', # 600-650
'0.075', # 650-700
'0.162', # 700-750
'0.082' ] # 750-800


## E_TRIG
list_E_TRIG_bg_4e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'1.145', #  70- 80
'0.897', #  80- 90
'0.808', #  90-100
'0.796', # 100-110
'0.482', # 110-120
'0.451', # 120-130
'0.410', # 130-140
'0.296', # 140-150
'0.263', # 150-160
'0.182', # 160-170
'0.111', # 170-180
'0.084', # 180-190
'0.081', # 190-200
'0.074', # 200-210
'0.067', # 210-220
'0.056', # 220-230
'0.063', # 230-240
'0.060', # 240-250
'0.057', # 250-275
'0.049', # 275-300
'0.049', # 300-325
'0.052', # 325-350
'0.053', # 350-375
'0.060', # 375-400
'0.039', # 400-425
'0.035', # 425-450
'0.032', # 450-475
'0.058', # 475-500
'0.034', # 500-550
'0.020', # 550-600
'0.033', # 600-650
'0.042', # 650-700
'0.022', # 700-750
'0.035' ] # 750-800

list_E_TRIG_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.724', #  80- 90
'0.711', #  90-100
'0.583', # 100-110
'0.453', # 110-120
'0.416', # 120-130
'0.254', # 130-140
'0.319', # 140-150
'0.195', # 150-160
'0.208', # 160-170
'0.129', # 170-180
'0.100', # 180-190
'0.089', # 190-200
'0.097', # 200-210
'0.096', # 210-220
'0.106', # 220-230
'0.113', # 230-240
'0.114', # 240-250
'0.112', # 250-275
'0.112', # 275-300
'0.121', # 300-325
'0.105', # 325-350
'0.111', # 350-375
'0.097', # 375-400
'0.100', # 400-425
'0.073', # 425-450
'0.095', # 450-475
'0.082', # 475-500
'0.085', # 500-550
'0.129', # 550-600
'0.055', # 600-650
'0.065', # 650-700
'0.055', # 700-750
'0.051' ] # 750-800

list_E_TRIG_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.000', #  80- 90
'0.000', #  90-100
'0.000', # 100-110
'0.145', # 110-120
'0.022', # 120-130
'0.152', # 130-140
'0.127', # 140-150
'0.143', # 150-160
'0.147', # 160-170
'0.129', # 170-180
'0.106', # 180-190
'0.101', # 190-200
'0.116', # 200-210
'0.116', # 210-220
'0.115', # 220-230
'0.136', # 230-240
'0.114', # 240-250
'0.128', # 250-275
'0.109', # 275-300
'0.127', # 300-325
'0.116', # 325-350
'0.103', # 350-375
'0.145', # 375-400
'0.151', # 400-425
'0.116', # 425-450
'0.095', # 450-475
'0.094', # 475-500
'0.137', # 500-550
'0.116', # 550-600
'0.101', # 600-650
'0.054', # 650-700
'0.134', # 700-750
'0.172' ] # 750-800


## M_TRIG
list_M_TRIG_bg_4mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'2.257', #  70- 80
'1.362', #  80- 90
'1.475', #  90-100
'1.586', # 100-110
'1.016', # 110-120
'1.188', # 120-130
'0.945', # 130-140
'0.871', # 140-150
'0.798', # 150-160
'0.640', # 160-170
'0.512', # 170-180
'0.421', # 180-190
'0.403', # 190-200
'0.411', # 200-210
'0.420', # 210-220
'0.408', # 220-230
'0.430', # 230-240
'0.429', # 240-250
'0.436', # 250-275
'0.410', # 275-300
'0.409', # 300-325
'0.411', # 325-350
'0.355', # 350-375
'0.359', # 375-400
'0.317', # 400-425
'0.371', # 425-450
'0.326', # 450-475
'0.398', # 475-500
'0.300', # 500-550
'0.272', # 550-600
'0.260', # 600-650
'0.285', # 650-700
'0.249', # 700-750
'0.200' ] # 750-800

list_M_TRIG_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.000', #  80- 90
'0.139', #  90-100
'0.191', # 100-110
'0.083', # 110-120
'0.082', # 120-130
'0.138', # 130-140
'0.133', # 140-150
'0.136', # 150-160
'0.190', # 160-170
'0.135', # 170-180
'0.113', # 180-190
'0.104', # 190-200
'0.096', # 200-210
'0.118', # 210-220
'0.116', # 220-230
'0.130', # 230-240
'0.129', # 240-250
'0.118', # 250-275
'0.115', # 275-300
'0.125', # 300-325
'0.100', # 325-350
'0.118', # 350-375
'0.089', # 375-400
'0.099', # 400-425
'0.067', # 425-450
'0.081', # 450-475
'0.056', # 475-500
'0.064', # 500-550
'0.095', # 550-600
'0.044', # 600-650
'0.035', # 650-700
'0.034', # 700-750
'0.029' ] # 750-800

list_M_TRIG_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'1.558', #  80- 90
'1.532', #  90-100
'1.290', # 100-110
'0.821', # 110-120
'0.931', # 120-130
'1.024', # 130-140
'0.624', # 140-150
'0.501', # 150-160
'0.282', # 160-170
'0.273', # 170-180
'0.153', # 180-190
'0.161', # 190-200
'0.137', # 200-210
'0.146', # 210-220
'0.137', # 220-230
'0.155', # 230-240
'0.157', # 240-250
'0.144', # 250-275
'0.126', # 275-300
'0.142', # 300-325
'0.124', # 325-350
'0.125', # 350-375
'0.150', # 375-400
'0.124', # 400-425
'0.151', # 425-450
'0.079', # 450-475
'0.091', # 475-500
'0.070', # 500-550
'0.056', # 550-600
'0.079', # 600-650
'0.047', # 650-700
'0.074', # 700-750
'0.200' ] # 750-800


## E_CUTS
list_E_CUTS_bg_4e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'5.657', #  70- 80
'3.912', #  80- 90
'3.782', #  90-100
'3.967', # 100-110
'3.996', # 110-120
'2.906', # 120-130
'2.466', # 130-140
'1.883', # 140-150
'1.404', # 150-160
'1.123', # 160-170
'0.677', # 170-180
'0.423', # 180-190
'0.335', # 190-200
'0.454', # 200-210
'0.407', # 210-220
'0.420', # 220-230
'0.557', # 230-240
'0.514', # 240-250
'0.560', # 250-275
'0.564', # 275-300
'0.623', # 300-325
'0.717', # 325-350
'0.665', # 350-375
'0.665', # 375-400
'0.925', # 400-425
'0.565', # 425-450
'0.876', # 450-475
'0.658', # 475-500
'0.503', # 500-550
'0.419', # 550-600
'0.692', # 600-650
'0.332', # 650-700
'0.450', # 700-750
'0.163' ] # 750-800

list_E_CUTS_bg_2e2mu = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'0.000', #  80- 90
'1.252', #  90-100
'0.334', # 100-110
'0.196', # 110-120
'0.241', # 120-130
'0.010', # 130-140
'0.088', # 140-150
'0.355', # 150-160
'0.224', # 160-170
'0.076', # 170-180
'0.135', # 180-190
'0.127', # 190-200
'0.106', # 200-210
'0.128', # 210-220
'0.171', # 220-230
'0.182', # 230-240
'0.195', # 240-250
'0.219', # 250-275
'0.222', # 275-300
'0.284', # 300-325
'0.236', # 325-350
'0.431', # 350-375
'0.254', # 375-400
'0.272', # 400-425
'0.206', # 425-450
'0.262', # 450-475
'0.218', # 475-500
'0.241', # 500-550
'0.324', # 550-600
'0.183', # 600-650
'0.111', # 650-700
'0.002', # 700-750
'0.000' ] # 750-800

list_E_CUTS_bg_2mu2e = [ '0.000', #   0- 10
'0.000', #  10- 20
'0.000', #  20- 30
'0.000', #  30- 40
'0.000', #  40- 50
'0.000', #  50- 60
'0.000', #  60- 70
'0.000', #  70- 80
'5.110', #  80- 90
'4.418', #  90-100
'2.460', # 100-110
'3.648', # 110-120
'2.347', # 120-130
'2.688', # 130-140
'1.766', # 140-150
'1.344', # 150-160
'0.676', # 160-170
'0.599', # 170-180
'0.251', # 180-190
'0.252', # 190-200
'0.277', # 200-210
'0.277', # 210-220
'0.248', # 220-230
'0.296', # 230-240
'0.247', # 240-250
'0.377', # 250-275
'0.423', # 275-300
'0.339', # 300-325
'0.396', # 325-350
'0.420', # 350-375
'0.368', # 375-400
'0.476', # 400-425
'0.455', # 425-450
'0.376', # 450-475
'0.513', # 475-500
'0.258', # 500-550
'0.367', # 550-600
'0.618', # 600-650
'0.095', # 650-700
'0.511', # 700-750
'0.902' ] # 750-800



####


channels = ['4mu', '2mu2e', '2e2mu', '4e']

datadriven_yield = {}
datadriven_syst = {}
for chan in channels:
  datadriven_yield[chan] = {}
  datadriven_syst[chan] = {}

if (tag == 'mc11c'):
  datadriven_yield['4mu']['histoZ'] = 0.
  datadriven_yield['4mu']['histoZbb'] = 0.250
  datadriven_yield['4mu']['histott'] = 0.022
  datadriven_yield['2e2mu']['histoZ'] = 0.
  datadriven_yield['2e2mu']['histoZbb'] = 0.201
  datadriven_yield['2e2mu']['histott'] = 0.020
  datadriven_yield['2mu2e']['histoZ'] = 2.6
  datadriven_yield['2mu2e']['histoZbb'] = 0.
  datadriven_yield['2mu2e']['histott'] = 0.
  datadriven_yield['4e']['histoZ'] = 3.1
  datadriven_yield['4e']['histoZbb'] = 0.
  datadriven_yield['4e']['histott'] = 0.
  datadriven_syst['4mu']['Zbb'] = sum_sq([0.103, 0.079])
  datadriven_syst['4mu']['tt']  = sum_sq([0.010, 0.011])
  datadriven_syst['4mu']['Z']  = 0.
  datadriven_syst['2e2mu']['Zbb'] = sum_sq([0.083, 0.063])
  datadriven_syst['2e2mu']['tt']  = sum_sq([0.009, 0.011])
  datadriven_syst['2e2mu']['Z']  = 0.
  datadriven_syst['2mu2e']['Zbb'] = 0.
  datadriven_syst['2mu2e']['tt']  = 0.
  datadriven_syst['2mu2e']['Z']  = sum_sq([0.4, 0.4])
  datadriven_syst['4e']['Zbb'] = 0.
  datadriven_syst['4e']['tt']  = 0.
  datadriven_syst['4e']['tt']  = sum_sq([0.6, 0.5])
elif (tag == 'mc12a'):
  datadriven_yield['4mu']['histoZ'] = 0.
  datadriven_yield['4mu']['histoZbb'] = 0.506
  datadriven_yield['4mu']['histott'] = 0.044
  datadriven_yield['2e2mu']['histoZ'] = 0.
  datadriven_yield['2e2mu']['histoZbb'] = 0.405
  datadriven_yield['2e2mu']['histott'] = 0.040
  datadriven_yield['2mu2e']['histoZ'] = 4.9
  datadriven_yield['2mu2e']['histoZbb'] = 0.
  datadriven_yield['2mu2e']['histott'] = 0.
  datadriven_yield['4e']['histoZ'] = 3.9
  datadriven_yield['4e']['histoZbb'] = 0.
  datadriven_yield['4e']['histott'] = 0.
  datadriven_syst['4mu']['Zbb'] = sum_sq([0.127, 0.159])
  datadriven_syst['4mu']['tt']  = sum_sq([0.015, 0.150])
  datadriven_syst['4mu']['Z']  = 0.
  datadriven_syst['2e2mu']['Zbb'] = sum_sq([0.102, 0.127])
  datadriven_syst['2e2mu']['tt']  = sum_sq([0.013, 0.013])
  datadriven_syst['2e2mu']['Z']  = 0.
  datadriven_syst['2mu2e']['Zbb'] = 0.
  datadriven_syst['2mu2e']['tt']  = 0.
  datadriven_syst['2mu2e']['Z']  = sum_sq([0.8, 0.7])
  datadriven_syst['4e']['Zbb'] = 0.
  datadriven_syst['4e']['tt']  = 0.
  datadriven_syst['4e']['tt']  = sum_sq([0.7, 0.8])


# reducible
print '### REDUCIBLE BACKGROUND ###'
for chan in channels:
  result_yield = sum([datadriven_yield[chan][x] for x in datadriven_yield[chan].keys()])
  result_syst  = sum_sq([datadriven_syst[chan][x] for x in datadriven_syst[chan].keys()])
  print '[%s] yield = %lf abs = %lf   rel = %lf' % (chan, result_yield, result_syst, result_syst/result_yield)
  result_yield_low = samples[6].yield_low[chan] # 6-th sample, in get_tables.py, is the sum of reducibles
  final_result_low[chan]['redux'][0] = result_yield_low
  final_result_low[chan]['redux'][1] = result_yield_low * result_syst/result_yield
  result_yield_high = samples[6].yield_high[chan]
  final_result_high[chan]['redux'][0] = result_yield_high
  final_result_high[chan]['redux'][1] = result_yield_high * result_syst/result_yield

# ZZ
def get_ZZ_EFF_syst_rel(chan, mass):
  if (mass == 130):
    bin = 12
  elif (mass == 300):
    bin = 26

  if (chan == '4mu'):
    return 0.01 * float(list_M_EFF_bg_4mu[bin])
  elif (chan == '2mu2e'):
    return 0.01 * sum_sq([float(list_E_EFF_bg_2mu2e[bin]), float(list_M_EFF_bg_2mu2e[bin])])
  elif (chan == '2e2mu'):
    return 0.01 * sum_sq([float(list_E_EFF_bg_2e2mu[bin]), float(list_M_EFF_bg_2e2mu[bin])])
  elif (chan == '4e'):
    return 0.01 * float(list_E_EFF_bg_4e[bin])

def get_ZZ_CUTS_syst_rel(chan, mass):
  if (mass == 130):
    bin = 12
  elif (mass == 300):
    bin = 26

  if (chan == '4mu'):
    return 0.
  elif (chan == '2mu2e'):
    return 0.01 * sum_sq([float(list_E_CUTS_bg_2mu2e[bin]), 0])#float(list_M_CUTS_bg_2mu2e[bin])])
  elif (chan == '2e2mu'):
    return 0.01 * sum_sq([float(list_E_CUTS_bg_2e2mu[bin]), 0])#list_M_CUTS_bg_2e2mu[bin])])
  elif (chan == '4e'):
    return 0.01 * float(list_E_CUTS_bg_4e[bin])


print ''
print ''
print '### IRREDUCIBLE BACKGROUND ###'
for chan in channels:
  # yields
  ZZ_yield_low = samples[0].yield_low[chan]
  ZZ_yield_high = samples[0].yield_high[chan]
  qqZZ_yield_low = samples[0].partial_yield_low[chan][0]
  qqZZ_yield_high = samples[0].partial_yield_high[chan][0]
  ggZZ_yield_low = samples[0].partial_yield_low[chan][1]
  ggZZ_yield_high = samples[0].partial_yield_high[chan][1]

  # systs (qq)
  qqZZ_syst_low_theory_rel = get_theory_qqZZ_relative_syst(130)
  qqZZ_syst_high_theory_rel = get_theory_qqZZ_relative_syst(300)
  qqZZ_syst_low_EFF_rel = get_ZZ_EFF_syst_rel(chan, 130)
  qqZZ_syst_high_EFF_rel = get_ZZ_EFF_syst_rel(chan, 300)
  qqZZ_syst_low_CUTS_rel = get_ZZ_CUTS_syst_rel(chan, 130)
  qqZZ_syst_high_CUTS_rel = get_ZZ_CUTS_syst_rel(chan, 300)
  qqZZ_syst_low = qqZZ_yield_low * sum_sq([qqZZ_syst_low_theory_rel, qqZZ_syst_low_EFF_rel, qqZZ_syst_low_CUTS_rel])
  qqZZ_syst_high = qqZZ_yield_high * sum_sq([qqZZ_syst_high_theory_rel, qqZZ_syst_high_EFF_rel, qqZZ_syst_high_CUTS_rel])

  # systs (gg)
  ggZZ_syst_low_theory_rel = get_theory_ggZZ_relative_syst(130)
  ggZZ_syst_high_theory_rel = get_theory_ggZZ_relative_syst(300)
  ggZZ_syst_low_EFF_rel = get_ZZ_EFF_syst_rel(chan, 130)
  ggZZ_syst_high_EFF_rel = get_ZZ_EFF_syst_rel(chan, 300)
  ggZZ_syst_low_CUTS_rel = get_ZZ_CUTS_syst_rel(chan, 130)
  ggZZ_syst_high_CUTS_rel = get_ZZ_CUTS_syst_rel(chan, 300)
  ggZZ_syst_low = ggZZ_yield_low * sum_sq([ggZZ_syst_low_theory_rel, ggZZ_syst_low_EFF_rel, ggZZ_syst_low_CUTS_rel])
  ggZZ_syst_high = ggZZ_yield_high * sum_sq([ggZZ_syst_high_theory_rel, ggZZ_syst_high_EFF_rel, ggZZ_syst_high_CUTS_rel])


  # systs (tot)
  ZZ_syst_low = sum_sq([qqZZ_syst_low, ggZZ_syst_low])
  ZZ_syst_high = sum_sq([qqZZ_syst_high, ggZZ_syst_high])

  print '[%s] low :: yield=%lf abs=%lf rel=%lf ' % (chan, ZZ_yield_low, ZZ_syst_low, ZZ_syst_low/ZZ_yield_low)
  print '[%s] high :: yield=%lf abs=%lf rel=%lf ' % (chan, ZZ_yield_high, ZZ_syst_high, ZZ_syst_high/ZZ_yield_high)

  final_result_low[chan]['ZZ'][0] = ZZ_yield_low
  final_result_low[chan]['ZZ'][1] = ZZ_syst_low
  final_result_high[chan]['ZZ'][0] = ZZ_yield_high
  final_result_high[chan]['ZZ'][1] = ZZ_syst_high


print ''
print ''
print '### SIGNAL ###'

from ROOT import *
gSystem.AddIncludePath('-IHiggsZZ4lUtils')
gSystem.Load('libHiggsZZ4lUtils')
gSystem.Load('libCint')
gROOT.ProcessLine('.L HiggsZZ4lUtils/HiggsZZ4lUtils/CrossSection.h+')
gROOT.ProcessLine('.L HiggsZZ4lUtils/HiggsZZ4lUtils/HiggsCrossSection.h+')
gROOT.ProcessLine('.L HiggsZZ4lUtils/HiggsZZ4lUtils/BkgCrossSection.h+')

higgs_xsector = HiggsCrossSection()

COM_energy = CrossSections.SevenTeV if tag == 'mc11c' else CrossSections.EightTeV

def get_signal_unc_relative_ggF(mass):
  doppel = higgs_xsector.higgsprodxsecuncGGF(mass, COM_energy)

  return 0.01 * (doppel.first + doppel.second) / 2.0 # average (and interpret as relative, not percentage)

def get_signal_unc_relative_VBF(mass):
  doppel = higgs_xsector.higgsprodxsecuncVBF(mass, COM_energy)

  return 0.01 * (doppel.first + doppel.second) / 2.0 # average (and interpret as relative, not percentage)

def get_signal_unc_relative_EFF(mass, chan):
  if chan == '4e':
    return 0.01 * float(numpy.interp(int(mass), listMassSys, list_E_EFF_sig_4e)) #float(list_E_EFF_sig_4e[idx])
  elif chan == '4mu':
    return 0.01 * float(numpy.interp(int(mass), listMassSys, list_M_EFF_sig_4mu)) #float(list_E_EFF_sig_4e[idx])
  elif chan == '2mu2e':
    return 0.01 * sum_sq([float(numpy.interp(int(mass), listMassSys, list_E_EFF_sig_2mu2e)),
                          float(numpy.interp(int(mass), listMassSys, list_M_EFF_sig_2mu2e))]) #float(list_E_EFF_sig_4e[idx])
  elif chan == '2e2mu':
    return 0.01 * sum_sq([float(numpy.interp(int(mass), listMassSys, list_E_EFF_sig_2e2mu)),
                          float(numpy.interp(int(mass), listMassSys, list_M_EFF_sig_2e2mu))]) #float(list_E_EFF_sig_4e[idx])

def get_signal_unc_relative_CUTS(mass, chan):
  if chan == '4e':
    return 0.01 * float(numpy.interp(int(mass), listMassSys2, list_E_CUTS_sig_4e))
  elif chan == '4mu':
    return 0.
  elif chan == '2mu2e':
    return 0.01 * sum_sq([0., float(numpy.interp(int(mass), listMassSys2, list_E_CUTS_sig_2mu2e))]) #float(list_E_CUTS_sig_2mu2e[idx])])
  elif chan == '2e2mu':
    return 0.01 * sum_sq([0., float(numpy.interp(int(mass), listMassSys2, list_E_CUTS_sig_2e2mu))]) #float(list_E_CUTS_sig_2e2mu[idx])])


for i, mass in enumerate([125, 130, 150, 190, 400, 600, 120]):
  print '{mH=%d}' % mass
  for chan in channels:
    index = i + 9
    tot_yield_tot = samples[index].yield_tot[chan] # total (ggF+VBF) yield in the full mass range
    ggF_yield_tot = samples[index].partial_yield_tot[chan][0] # 0 is ggF, 1 is VBF
    VBF_yield_tot = samples[index].partial_yield_tot[chan][1] 
   #tot_yield_tot = samples[index].yield_low[chan] # total (ggF+VBF) yield in the full mass range # kostas
   #ggF_yield_tot = samples[index].partial_yield_low[chan][0] # 0 is ggF, 1 is VBF # kostas
   #VBF_yield_tot = samples[index].partial_yield_low[chan][1]  # kostas

    ggF_syst_tot = ggF_yield_tot * sum_sq([get_signal_unc_relative_ggF(mass), get_signal_unc_relative_EFF(mass, chan), get_signal_unc_relative_CUTS(mass, chan)])
    VBF_syst_tot = VBF_yield_tot * sum_sq([get_signal_unc_relative_ggF(mass), get_signal_unc_relative_EFF(mass, chan), get_signal_unc_relative_CUTS(mass, chan)])

    tot_syst_tot = sum_sq([ggF_syst_tot, VBF_syst_tot])

    print '[%s] tot :: yield=%lf abs=%lf rel=%lf ' % (chan, tot_yield_tot,  tot_syst_tot, tot_syst_tot/tot_yield_tot if tot_yield_tot != 0 else -9999)

    final_result_low[chan][str(mass)][0] = tot_yield_tot
    final_result_low[chan][str(mass)][1] = tot_syst_tot
    final_result_high[chan][str(mass)][0] = tot_yield_tot # high mass is filled but not used afterwards!!!
    final_result_high[chan][str(mass)][1] = tot_syst_tot


### sum bkg
for chan in channels:
  final_result_low[chan]['tot'][0] = final_result_low[chan]['ZZ'][0] + final_result_low[chan]['redux'][0]
  final_result_low[chan]['tot'][1] = sum_sq([final_result_low[chan]['ZZ'][1], final_result_low[chan]['redux'][1]])
  final_result_high[chan]['tot'][0] = final_result_high[chan]['ZZ'][0] + final_result_high[chan]['redux'][0]
  final_result_high[chan]['tot'][1] = sum_sq([final_result_high[chan]['ZZ'][1], final_result_high[chan]['redux'][1]])


### FINAL PRINTOUT

print ''
print ''
print ''
print ''
print ''

source_name = {}
source_name['ZZ'] = r'$\tabscript{ZZ}{(*)}{}$'
source_name['redux'] = r'$Z$, $Zb\bar{b}$, and $t\bar{t}$'
source_name['tot'] = r'Total Background'
source_name['125'] = r'$m_{H}=125\:\gev$'
source_name['130'] = r'$m_{H}=130\:\gev$'
source_name['150'] = r'$m_{H}=150\:\gev$'
source_name['190'] = r'$m_{H}=190\:\gev$'
source_name['400'] = r'$m_{H}=400\:\gev$'
source_name['600'] = r'$m_{H}=600\:\gev$'
source_name['120'] = r'$m_{H}=120\:\gev$'

for i, source in enumerate(final_sources):
  unc_2e2mu_low = sum_sq([final_result_low['2mu2e'][source][1], final_result_low['2e2mu'][source][1]])
  unc_2e2mu_high = sum_sq([final_result_high['2mu2e'][source][1], final_result_high['2e2mu'][source][1]])

  if i >= 3:
    # signal
    what = (source_name[source], final_result_low['4mu'][source][0], final_result_low['4mu'][source][1], final_result_low['2mu2e'][source][0] + final_result_low['2e2mu'][source][0], unc_2e2mu_low, final_result_low['4e'][source][0], final_result_low['4e'][source][1])
    print r'%s & \multicolumn{2}{c}{%.2lf\pm%.2lf} & \multicolumn{2}{c}{%.2lf\pm%.2lf} & \multicolumn{2}{c}{%.2lf\pm%.2lf}\\' % what

  else:
    what = (source_name[source], final_result_low['4mu'][source][0], final_result_low['4mu'][source][1], final_result_high['4mu'][source][0], final_result_high['4mu'][source][1], final_result_low['2mu2e'][source][0] + final_result_low['2e2mu'][source][0], unc_2e2mu_low, final_result_high['2mu2e'][source][0] + final_result_high['2e2mu'][source][0], unc_2e2mu_high, final_result_low['4e'][source][0], final_result_low['4e'][source][1], final_result_high['4e'][source][0], final_result_high['4e'][source][1])
    print r'%s & %.2lf\pm%.2lf & %.2lf\pm%.2lf & %.2lf\pm%.2lf & %.2lf\pm%.2lf & %.2lf\pm%.2lf & %.2lf\pm%.2lf\\' % what


print ''
print ''
print ''
print ''
print ''
print ' %%%%%% table below refers to the same mass interval [%lf, %lf]! %%%%%%' % (minimum_mass, mass_boundary)

print r'$\mH$ & exp. signal & exp. bkg & obs \\'
print r'\hline'
print r'\multicolumn{4}{c}{$4\mu$}\\'
print r'\hline'
print r'120 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['4mu']['120'][0], final_result_low['4mu']['120'][1], final_result_low['4mu']['tot'][0], final_result_low['4mu']['tot'][1], samples[8].yield_low['4mu']) # sample 8 is data
print r'125 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['4mu']['125'][0], final_result_low['4mu']['125'][1], final_result_low['4mu']['tot'][0], final_result_low['4mu']['tot'][1], samples[8].yield_low['4mu']) # sample 8 is data
print r'130 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['4mu']['130'][0], final_result_low['4mu']['130'][1], final_result_low['4mu']['tot'][0], final_result_low['4mu']['tot'][1], samples[8].yield_low['4mu']) # sample 8 is data
print r'\hline'
print r'\multicolumn{4}{c}{$2e2\mu$ and $2\mu2e$}\\'
print r'\hline'
print r'120 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['2mu2e']['120'][0]+final_result_low['2e2mu']['120'][0], sum_sq([final_result_low['2mu2e']['120'][1], final_result_low['2e2mu']['120'][1]]), final_result_low['2mu2e']['tot'][0]+final_result_low['2e2mu']['tot'][0], sum_sq([final_result_low['2mu2e']['tot'][1], final_result_low['2e2mu']['tot'][1]]) , samples[8].yield_low['2mu2e']+samples[8].yield_low['2e2mu']) # sample 8 is data
print r'125 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['2mu2e']['125'][0]+final_result_low['2e2mu']['125'][0], sum_sq([final_result_low['2mu2e']['125'][1], final_result_low['2e2mu']['125'][1]]), final_result_low['2mu2e']['tot'][0]+final_result_low['2e2mu']['tot'][0], sum_sq([final_result_low['2mu2e']['tot'][1], final_result_low['2e2mu']['tot'][1]]) , samples[8].yield_low['2mu2e']+samples[8].yield_low['2e2mu']) # sample 8 is data
print r'130 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['2mu2e']['130'][0]+final_result_low['2e2mu']['130'][0], sum_sq([final_result_low['2mu2e']['130'][1], final_result_low['2e2mu']['130'][1]]), final_result_low['2mu2e']['tot'][0]+final_result_low['2e2mu']['tot'][0], sum_sq([final_result_low['2mu2e']['tot'][1], final_result_low['2e2mu']['tot'][1]]) , samples[8].yield_low['2mu2e']+samples[8].yield_low['2e2mu']) # sample 8 is data
print r'\hline'
print r'\multicolumn{4}{c}{$4e$}\\'
print r'\hline'
print r'120 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['4e']['120'][0], final_result_low['4e']['120'][1], final_result_low['4e']['tot'][0], final_result_low['4e']['tot'][1], samples[8].yield_low['4e']) # sample 8 is data
print r'125 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['4e']['125'][0], final_result_low['4e']['125'][1], final_result_low['4e']['tot'][0], final_result_low['4e']['tot'][1], samples[8].yield_low['4e']) # sample 8 is data
print r'130 & %.2lf$\pm$%.2lf %.2lf$\pm$ %.2lf & %.0lf \\ ' % (final_result_low['4e']['130'][0], final_result_low['4e']['130'][1], final_result_low['4e']['tot'][0], final_result_low['4e']['tot'][1], samples[8].yield_low['4e']) # sample 8 is data
print r'\hline\hline'
print r''
